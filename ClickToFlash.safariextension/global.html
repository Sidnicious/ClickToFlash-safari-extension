<script type="text/javascript">
	safari.application.addEventListener("message", function(event) {
		switch (event.name) {
			case "canLoad":
				if (event.message === "getSettings") {
					event.message = {
						useH264: safari.extension.settings["useH264"],
						useHDH264: safari.extension.settings["useHDH264"],
						sifrReplacement: safari.extension.settings["sifrReplacement"],
						whitelist: safari.extension.settings["whitelist"] || ""
					};
				}
				break;
			case "setWhitelist":
				safari.extension.settings["whitelist"] = event.message;
				break;
		}
	}, false);
</script>